!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("rxjs"),require("rxjs/operators"),require("@angular/common"),require("@angular/core"),require("@angular/router")):"function"==typeof define&&define.amd?define("xng-breadcrumb",["exports","rxjs","rxjs/operators","@angular/common","@angular/core","@angular/router"],r):r(e["xng-breadcrumb"]={},e.rxjs,e.rxjs.operators,e.ng.common,e.ng.core,e.ng.router)}(this,function(e,t,a,r,n,i){"use strict";var s=(o.decorators=[{type:n.Directive,args:[{selector:"[xngBreadcrumbItem]"}]}],o.ctorParameters=function(){return[]},o);function o(){}var m=function(){return(m=Object.assign||function(e){for(var r,t=1,a=arguments.length;t<a;t++)for(var n in r=arguments[t])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e}).apply(this,arguments)};function u(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var a,n,i=t.call(e),s=[];try{for(;(void 0===r||0<r--)&&!(a=i.next()).done;)s.push(a.value)}catch(o){n={error:o}}finally{try{a&&!a.done&&(t=i["return"])&&t.call(i)}finally{if(n)throw n.error}}return s}var c=(d.prototype.set=function(e,r){if(this.validateArguments(e,r))if("string"==typeof r&&(r={label:r}),e.startsWith("@"))this.updateStore(m({},r,{alias:e.slice(1)}));else{var t=this.buildRouteRegExp(e);this.updateStore(m({},r,t))}},d.prototype.setBaseBreadcrumb=function(){var e=this.router.config.find(function(e){return""===e.path});if(e&&e.data){var r=this.getBreadcrumbOptions(e.data),t=r.label,a=r.alias,n=r.skip,i=void 0!==n&&n,s=r.info,o=r.disable,u=void 0!==o&&o,c=!1;"string"==typeof t||t||(c=!(t="")),this.baseBreadcrumb={label:t,alias:a,skip:i,disable:u,info:s,routeLink:this.baseHref,isAutoGeneratedLabel:c}}},d.prototype.detectRouteChanges=function(){var r=this;this.router.events.pipe(a.filter(function(e){return e instanceof i.NavigationEnd}),a.distinctUntilChanged()).subscribe(function(e){r.previousBreadcrumbs=r.currentBreadcrumbs,r.currentBreadcrumbs=r.baseBreadcrumb?[r.baseBreadcrumb]:[],r.prepareBreadcrumbList(r.activatedRoute.root,r.baseHref)})},d.prototype.prepareBreadcrumbList=function(e,r){if(e.routeConfig&&e.routeConfig.path){var t=this.prepareBreadcrumbItem(e,r);if(this.currentBreadcrumbs.push(t),e.firstChild)return this.prepareBreadcrumbList(e.firstChild,t.routeLink+"/")}else if(e.firstChild)return this.prepareBreadcrumbList(e.firstChild,r);var a=this.currentBreadcrumbs.filter(function(e){return!e.skip});this.breadcrumbs.next(a)},d.prototype.prepareBreadcrumbItem=function(e,r){var t=this.parseRouteData(e.routeConfig),a=t.path,n=t.breadcrumb,i=this.resolvePathParam(a,e),s=""+r+i,o=this.getFromStore(n.alias,s),u=o.label,c=o.alias,d=o.skip,l=o.disable,b=o.info,p=!1;return"string"!=typeof u&&("string"==typeof n.label?u=n.label:(u=i,p=!0)),m({label:u,alias:c||n.alias,skip:d||n.skip,disable:l||n.disable,info:b||n.info,routeLink:s,isAutoGeneratedLabel:p},this.resolveQueryParam(s,e))},d.prototype.parseRouteData=function(e){var r=e.path,t=e.data,a=void 0===t?{}:t;return{path:r,breadcrumb:this.mergeWithBaseChildData(e,m({},a))}},d.prototype.getFromStore=function(r,t){var e;return r&&(e=this.dynamicBreadcrumbStore.find(function(e){return e.alias===r})),!e&&t&&(e=this.dynamicBreadcrumbStore.find(function(e){return e.routeLink&&e.routeLink===t||e.routeRegex&&new RegExp(e.routeRegex).test(t+"/")})),e||{}},d.prototype.buildRouteRegExp=function(e){return e.startsWith("/")||(e="/"+e),e.includes(this.pathParamPrefix)?{routeRegex:e.replace(new RegExp(this.pathParamRegexIdentifier,"g"),this.pathParamRegexReplacer)}:{routeLink:e}},d.prototype.updateStore=function(e){var r=this.getBreadcrumbIndexes(e),t=r.breadcrumbItemIndex,a=r.storeItemIndex;if(-1<t){this.currentBreadcrumbs[t]=m({},this.currentBreadcrumbs[t],e);var n=this.currentBreadcrumbs.filter(function(e){return!e.skip});this.breadcrumbs.next(function i(){for(var e=[],r=0;r<arguments.length;r++)e=e.concat(u(arguments[r]));return e}(n))}-1<a?this.dynamicBreadcrumbStore[a]=m({},this.dynamicBreadcrumbStore[a],e):this.dynamicBreadcrumbStore.push(e)},d.prototype.getBreadcrumbIndexes=function(e){var r=e.alias,t=e.routeLink,a=e.routeRegex,n={};return r?n=this.getBreadcrumbIndexesByType("alias",r):t?n=this.getBreadcrumbIndexesByType("routeLink",t):a&&(n=this.getBreadcrumbIndexesByType("routeRegex",a)),n},d.prototype.getBreadcrumbIndexesByType=function(r,t){return{breadcrumbItemIndex:"routeRegex"!==r?this.currentBreadcrumbs.findIndex(function(e){return t===e[r]}):this.currentBreadcrumbs.findIndex(function(e){return new RegExp(t).test(e.routeLink)}),storeItemIndex:this.dynamicBreadcrumbStore.findIndex(function(e){return t===e[r]})}},d.prototype.resolvePathParam=function(e,r){return e.startsWith(this.pathParamPrefix)?r.snapshot.params[e.slice(1)]:e},d.prototype.resolveQueryParam=function(r,e){var t=this.previousBreadcrumbs.find(function(e){return e.routeLink===r})||{},a=e.snapshot,n=a.queryParams,i=a.fragment;return{queryParams:0<Object.keys(n).length?m({},n):t.queryParams,fragment:i||t.fragment}},d.prototype.mergeWithBaseChildData=function(e,r){return e?(e.loadChildren?t=e._loadedConfig.routes.find(function(e){return""===e.path}):e.children&&(t=e.children.find(function(e){return""===e.path})),t&&t.data?this.mergeWithBaseChildData(t,m({},this.getBreadcrumbOptions(r),this.getBreadcrumbOptions(t.data))):this.getBreadcrumbOptions(r)):this.getBreadcrumbOptions(r);var t},d.prototype.validateArguments=function(e,r){return null===e||e===undefined?(console.error("Invalid first argument. Please pass a route path or a breadcrumb alias."),!1):null!==r&&r!==undefined||(console.error("Invalid second argument. Please pass a string or an Object with breadcrumb options."),!1)},d.prototype.getBreadcrumbOptions=function(e){var r=e.breadcrumb;return"string"!=typeof r&&r||(r={label:r}),r},d.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],d.ctorParameters=function(){return[{type:i.ActivatedRoute},{type:i.Router}]},d.ngInjectableDef=n.ɵɵdefineInjectable({factory:function(){return new d(n.ɵɵinject(i.ActivatedRoute),n.ɵɵinject(i.Router))},token:d,providedIn:"root"}),d);function d(e,r){this.activatedRoute=e,this.router=r,this.baseHref="/",this.dynamicBreadcrumbStore=[],this.currentBreadcrumbs=[],this.previousBreadcrumbs=[],this.breadcrumbs=new t.BehaviorSubject([]),this.breadcrumbs$=this.breadcrumbs.asObservable(),this.pathParamPrefix=":",this.pathParamRegexIdentifier="/:[^/]+",this.pathParamRegexReplacer="/[^/]+",this.setBaseBreadcrumb(),this.detectRouteChanges()}var l=(Object.defineProperty(b.prototype,"separator",{get:function(){return this._separator},set:function(e){e instanceof n.TemplateRef?(this.separatorTemplate=e,this._separator=undefined):(this.separatorTemplate=undefined,this._separator=e||"/")},enumerable:!0,configurable:!0}),b.prototype.ngOnInit=function(){var r=this;this.subscription=this.breadcrumbService.breadcrumbs$.subscribe(function(e){r.breadcrumbs=e.map(function(e){return r.preserveQueryParams||(e.routeLink=e.routeLink.split("?")[0]),e}).filter(function(e){return!!r.autoGenerate||!e.isAutoGeneratedLabel})})},b.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},b.decorators=[{type:n.Component,args:[{selector:"xng-breadcrumb",template:'<nav aria-label="breadcrumb" class="xng-breadcrumb-root" [ngClass]="class">\n  <ol class="xng-breadcrumb-list">\n    <ng-container *ngFor="let breadcrumb of breadcrumbs; last as isLast; first as isFirst">\n      <li class="xng-breadcrumb-item">\n        <a\n          *ngIf="!isLast"\n          [routerLink]="[breadcrumb.routeLink]"\n          class="xng-breadcrumb-link"\n          [ngClass]="{ \'xng-breadcrumb-link-disabled\': breadcrumb.disable }"\n          [attr.aria-disabled]="breadcrumb.disable"\n          [queryParams]="breadcrumb.queryParams"\n          [fragment]="breadcrumb.fragment"\n        >\n          <ng-container\n            *ngTemplateOutlet="itemTemplate; context: { $implicit: breadcrumb.label, info: breadcrumb.info, last: isLast, first: isFirst }"\n          ></ng-container>\n          <ng-container *ngIf="!itemTemplate">{{ breadcrumb.label }}</ng-container>\n        </a>\n\n        <label *ngIf="isLast" class="xng-breadcrumb-trail">\n          <ng-container\n            *ngTemplateOutlet="itemTemplate; context: { $implicit: breadcrumb.label, info: breadcrumb.info, last: isLast, first: isFirst }"\n          ></ng-container>\n          <ng-container *ngIf="!itemTemplate">{{ breadcrumb.label }}</ng-container>\n        </label>\n      </li>\n\n      <li *ngIf="!isLast" class="xng-breadcrumb-separator" aria-hidden="true" role="separator">\n        <ng-container *ngTemplateOutlet="separatorTemplate"></ng-container>\n        <ng-container *ngIf="!separatorTemplate">{{ separator }}</ng-container>\n      </li>\n    </ng-container>\n  </ol>\n</nav>\n',encapsulation:n.ViewEncapsulation.None,styles:[".xng-breadcrumb-root{margin:0;color:rgba(0,0,0,.6)}.xng-breadcrumb-list{display:flex;align-items:center;flex-wrap:wrap;margin:0;padding:0}.xng-breadcrumb-item{list-style:none}.xng-breadcrumb-trail{display:flex;align-items:center;color:rgba(0,0,0,.9)}.xng-breadcrumb-link{display:flex;align-items:center;white-space:nowrap;color:inherit;text-decoration:none;transition:text-decoration .3s;transition:text-decoration .3s,-webkit-text-decoration .3s}.xng-breadcrumb-link:hover{text-decoration:underline}.xng-breadcrumb-link-disabled{pointer-events:none;cursor:disabled}.xng-breadcrumb-separator{display:flex;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin-left:8px;margin-right:8px}"]}]}],b.ctorParameters=function(){return[{type:c}]},b.propDecorators={itemTemplate:[{type:n.ContentChild,args:[s,{"static":!1,read:n.TemplateRef}]}],autoGenerate:[{type:n.Input}],preserveQueryParams:[{type:n.Input}],"class":[{type:n.Input}],separator:[{type:n.Input,args:["separator"]}]},b);function b(e){this.breadcrumbService=e,this._separator="/",this.autoGenerate=!0,this.preserveQueryParams=!0,this["class"]=""}var p=(f.decorators=[{type:n.NgModule,args:[{declarations:[l,s],imports:[r.CommonModule,i.RouterModule],exports:[l,s]}]}],f);function f(){}e.BreadcrumbItemDirective=s,e.BreadcrumbComponent=l,e.BreadcrumbModule=p,e.BreadcrumbService=c,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=xng-breadcrumb.umd.min.js.map